(()=>{var e={56:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],g=o[l]||0,m="".concat(l," ").concat(g);o[l]=g+1;var d=n(m),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)t[d].references++,t[d].updater(u);else{var A=s(u,r);r.byIndex=a,t.splice(a,0,{identifier:m,updater:A,references:1})}i.push(m)}return i}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var o=r(e=e||[],s=s||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var a=n(o[i]);t[a].references--}for(var c=r(e,s),l=0;l<o.length;l++){var g=n(o[l]);0===t[g].references&&(t[g].updater(),t.splice(g,1))}o=c}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},159:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,s,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var g=[].concat(e[l]);r&&i[g[0]]||(void 0!==o&&(void 0===g[5]||(g[1]="@layer".concat(g[5].length>0?" ".concat(g[5]):""," {").concat(g[1],"}")),g[5]=o),n&&(g[2]?(g[1]="@media ".concat(g[2]," {").concat(g[1],"}"),g[2]=n):g[2]=n),s&&(g[4]?(g[1]="@supports (".concat(g[4],") {").concat(g[1],"}"),g[4]=s):g[4]="".concat(s)),t.push(g))}},t}},601:e=>{"use strict";e.exports=function(e){return e[1]}},640:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(601),s=n.n(r),o=n(314),i=n.n(o)()(s());i.push([e.id,":root {\n  --etts-bg-primary: #ffffff;\n  --etts-bg-secondary: #f8f9fa;\n  --etts-text-primary: #000000;\n  --etts-text-secondary: #666666;\n  --etts-border-color: #cccccc;\n  --etts-button-bg: #007bff;\n  --etts-button-text: #ffffff;\n  --etts-hover-bg: #0056b3;\n}\n\n[data-theme='dark'] {\n  --etts-bg-primary: #1a1a1a;\n  --etts-bg-secondary: #2d2d2d;\n  --etts-text-primary: #ffffff;\n  --etts-text-secondary: #cccccc;\n  --etts-border-color: #404040;\n  --etts-button-bg: #0d6efd;\n  --etts-button-text: #ffffff;\n  --etts-hover-bg: #0b5ed7;\n}\n\n.etts-flex-center {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n}\n\n.etts-tts-icon {\n  width: 1rem;\n  height: 1rem;\n  margin-right: 0.25rem;\n  fill: none;\n  stroke: currentColor;\n}\n\n.etts-tts-input {\n  width: 100%;\n  padding-left: 0.75rem;\n  padding-right: 0.75rem;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  border: 1px solid #d1d5db;\n  border-radius: 0.375rem;\n  outline: none;\n}\n\n.etts-tts-input.etts-dark {\n  background-color: #1f2937;\n  border-color: #4b5563;\n  color: white;\n}\n\n.etts-transition-all {\n  transition: all 0.2s ease-in-out;\n}\n\n.etts-min-width-200 {\n  min-width: 200px;\n}\n\n.etts-space-x-3 {\n  display: flex;\n  gap: 0.75rem;\n}\n\n.etts-space-y-3 {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.etts-animate-spin {\n  animation: etts-spin 1s linear infinite;\n}\n\n@keyframes etts-spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.etts-spinner {\n  height: 1.25rem;\n  width: 1.25rem;\n  border: 2px solid #2563eb;\n  border-radius: 50%;\n  border-top-color: transparent;\n}\n\n.etts-lucide {\n  width: 20px;\n  height: 20px;\n  stroke: var(--etts-button-text);\n}\n\n.etts-tts-controls {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  background: var(--etts-bg-primary);\n  color: var(--etts-text-primary);\n  border: 1px solid var(--etts-border-color);\n  border-radius: 8px;\n  padding: 15px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n  z-index: 10000;\n  min-width: 200px;\n  transition: all 0.2s;\n}\n\n.etts-tts-button {\n  background: var(--etts-button-bg);\n  color: var(--etts-button-text);\n  border: none;\n  border-radius: 4px;\n  padding: 8px 16px;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.etts-tts-button:hover {\n  background: var(--etts-hover-bg);\n}\n\n.etts-tts-button.etts-red {\n  background: #dc3545;\n}\n\n.etts-tts-button.etts-red:hover {\n  background: #bb2d3b;\n}\n\n.etts-loading-spinner {\n  border: 2px solid var(--etts-bg-secondary);\n  border-top: 2px solid var(--etts-button-bg);\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  animation: etts-spin 1s linear infinite;\n}\n\n.etts-loading-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n}\n",""]);const a=i},659:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},815:function(e,t){var n,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const s=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},o=e=>1==e?"argument":"arguments",i=(e,t,n)=>new Proxy(t,{apply:(t,r,s)=>n.call(r,e,...s)});let a=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,t={},n={})=>{let r=Object.create(null),l={has:(t,n)=>n in e||n in r,get(l,g,m){if(g in r)return r[g];if(!(g in e))return;let d=e[g];if("function"==typeof d)if("function"==typeof t[g])d=i(e,e[g],t[g]);else if(a(n,g)){let t=((e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((o,i)=>{if(t.fallbackToNoCallback)try{n[e](...r,s({resolve:o,reject:i},t))}catch(s){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,s),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,o()}else t.noCallback?(n[e](...r),o()):n[e](...r,s({resolve:o,reject:i},t))}))})(g,n[g]);d=i(e,e[g],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(a(t,g)||a(n,g)))d=c(d,t[g],n[g]);else{if(!a(n,"*"))return Object.defineProperty(r,g,{configurable:!0,enumerable:!0,get:()=>e[g],set(t){e[g]=t}}),d;d=c(d,t[g],n["*"])}return r[g]=d,d},set:(t,n,s,o)=>(n in r?r[n]=s:e[n]=s,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},g=Object.create(e);return new Proxy(g,l)},l=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),g=new r((e=>"function"!=typeof e?e:function(t){const n=c(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),m=new r((e=>"function"!=typeof e?e:function(t,n,r){let s,o,i=!1,a=new Promise((e=>{s=function(t){i=!0,e(t)}}));try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}const c=!0!==o&&((l=o)&&"object"==typeof l&&"function"==typeof l.then);var l;if(!0!==o&&!c&&!i)return!1;return(c?o:a).then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),d=({reject:n,resolve:r},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?n(new Error(s.message)):r(s)},u=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const s=d.bind(null,{resolve:e,reject:t});r.push(s),n.sendMessage(...r)}))},A={devtools:{network:{onRequestFinished:l(g)}},runtime:{onMessage:l(m),onMessageExternal:l(m),sendMessage:u.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:u.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},h={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":h},services:{"*":h},websites:{"*":h}},c(e,A,n)};e.exports=n(chrome)}},void 0===(r=n.apply(t,[e]))||(e.exports=r)},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,s&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={id:r,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{"use strict";var e=n(815),t=n.n(e),r=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};class s{static getUnixTimestamp(){return Math.floor(Date.now()/1e3+this.clockSkewSeconds)}static sha256(e){return r(this,void 0,void 0,(function*(){const t=globalThis.crypto;if(!t||!t.subtle)throw new Error("Web Crypto API not available: crypto.subtle is required in this environment.");const n=(new TextEncoder).encode(e),r=yield t.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase()}))}static generateSecMsGec(){return r(this,void 0,void 0,(function*(){let e=this.getUnixTimestamp();e+=this.WIN_EPOCH,e-=e%300,e*=this.S_TO_NS/100;const t=`${Math.floor(e)}${this.TRUSTED_CLIENT_TOKEN}`;return yield this.sha256(t)}))}static setClockSkew(e){this.clockSkewSeconds=e}}s.WIN_EPOCH=11644473600,s.S_TO_NS=1e9,s.TRUSTED_CLIENT_TOKEN="6A5AA1D4EAFF4E9FB37E23D68491D6F4",s.clockSkewSeconds=0;var o=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};class i{static getCachedVoices(){return o(this,void 0,void 0,(function*(){try{const e=(yield t().storage.local.get(this.CACHE_KEY))[this.CACHE_KEY];if(!e)return null;return Date.now()-e.timestamp>e.ttl?(yield this.clearCache(),null):e.voices}catch(e){return console.warn("Failed to get cached voices:",e),null}}))}static setCachedVoices(e){return o(this,arguments,void 0,(function*(e,n=this.DEFAULT_TTL){try{const r={voices:e,timestamp:Date.now(),ttl:n};yield t().storage.local.set({[this.CACHE_KEY]:r})}catch(e){console.warn("Failed to cache voices:",e)}}))}static clearCache(){return o(this,void 0,void 0,(function*(){try{yield t().storage.local.remove(this.CACHE_KEY)}catch(e){console.warn("Failed to clear voice cache:",e)}}))}static getCacheStatus(){return o(this,void 0,void 0,(function*(){try{const e=(yield t().storage.local.get(this.CACHE_KEY))[this.CACHE_KEY];if(!e)return{exists:!1,voiceCount:0,ageMs:0,expiresInMs:0};const n=Date.now()-e.timestamp,r=Math.max(0,e.ttl-n);return{exists:!0,voiceCount:e.voices.length,ageMs:n,expiresInMs:r}}catch(e){return console.warn("Failed to get cache status:",e),{exists:!1,voiceCount:0,ageMs:0,expiresInMs:0}}}))}}i.CACHE_KEY="tts_voices_cache",i.DEFAULT_TTL=864e5;var a,c,l,g,m=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.AUDIO_24KHZ_48KBITRATE_MONO_MP3="audio-24khz-48kbitrate-mono-mp3",e.AUDIO_24KHZ_96KBITRATE_MONO_MP3="audio-24khz-96kbitrate-mono-mp3",e.WEBM_24KHZ_16BIT_MONO_OPUS="webm-24khz-16bit-mono-opus"}(a||(a={})),function(e){e.X_LOW="x-low",e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.X_HIGH="x-high",e.DEFAULT="default"}(c||(c={})),function(e){e.X_SLOW="x-slow",e.SLOW="slow",e.MEDIUM="medium",e.FAST="fast",e.X_FAST="x-fast",e.DEFAULT="default"}(l||(l={})),function(e){e.SILENT="silent",e.X_SOFT="x-soft",e.SOFT="soft",e.MEDIUM="medium",e.LOUD="loud",e.X_LOUD="x-LOUD",e.DEFAULT="default"}(g||(g={}));class d{constructor(){this.pitch="+0Hz",this.rate=1,this.volume=100}}class u{constructor(){this.eventListeners={data:[],close:[],end:[]}}on(e,t){this.eventListeners[e].push(t)}emit(e,t){this.eventListeners[e].forEach((e=>e(t)))}}class A{constructor(e=!1){this.ws=null,this.voice=null,this.voiceLocale=null,this.outputFormat=null,this.requestQueue={},this.connectionStartTime=0,this.enableLogging=e,this.isBrowser="undefined"!=typeof window&&void 0!==window.document}log(...e){this.enableLogging&&console.log(...e)}sendMessage(e){return m(this,void 0,void 0,(function*(){var t,n;let r=null;for(let s=1;s<=3;s++)try{if((null===(t=this.ws)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN&&(1===s&&(this.connectionStartTime=Date.now()),this.log(`Connecting... attempt ${s}`),yield this.initWebSocket()),(null===(n=this.ws)||void 0===n?void 0:n.readyState)===WebSocket.OPEN)return void this.ws.send(e)}catch(e){if(r=e instanceof Error?e:new Error(String(e)),this.log(`Connection attempt ${s} failed:`,r.message),s<3){const e=1e3*Math.pow(2,s-1);yield new Promise((t=>setTimeout(t,e)))}}throw new Error(`Failed to send message after 3 attempts. Last error: ${null==r?void 0:r.message}`)}))}initWebSocket(){return m(this,void 0,void 0,(function*(){const e=yield s.generateSecMsGec(),t={"Sec-MS-GEC":e,"Sec-MS-GEC-Version":A.SEC_MS_GEC_VERSION,Origin:"chrome-extension://jdiccldimpdaibmpdkjnbmckianbfold","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0"};if(this.isBrowser){const t=`${A.SYNTH_URL}&Sec-MS-GEC=${e}&Sec-MS-GEC-Version=${encodeURIComponent(A.SEC_MS_GEC_VERSION)}`;this.ws=new WebSocket(t)}else this.ws=new WebSocket(A.SYNTH_URL,{headers:t});this.ws.binaryType="arraybuffer";let n=[];return new Promise(((e,t)=>{this.ws.onopen=()=>{this.log("Connected in",(Date.now()-this.connectionStartTime)/1e3,"seconds"),this.sendMessage(this.getConfigMessage()).then(e)},this.ws.onmessage=e=>this.handleMessage(e,n),this.ws.onclose=()=>this.handleClose(),this.ws.onerror=e=>{this.log("WebSocket error:",e),t(new Error(`WebSocket connection failed: ${e}`))}}))}))}handleMessage(e,t){var n;const r=new Uint8Array(e.data),s=(new TextDecoder).decode(r),o=/X-RequestId:(.*?)\r\n/.exec(s),i=o?o[1]:"";if(s.includes("Path:turn.start"))t.length=0;else if(s.includes("Path:turn.end"))null===(n=this.requestQueue[i])||void 0===n||n.emit("end",t);else if(s.includes("Path:audio"))this.cacheAudioData(r,i);else if(s.includes("Path:audio.metadata")){const e=s.indexOf("{");t.push(JSON.parse(s.slice(e)).Metadata[0])}else this.log("Unknown Message",s)}handleClose(){this.log("Disconnected after:",(Date.now()-this.connectionStartTime)/1e3,"seconds");for(const e in this.requestQueue)this.requestQueue[e].emit("close",null)}cacheAudioData(e,t){var n;const r=(new TextEncoder).encode(A.BINARY_DELIM),s=this.findDelimiterIndex(e,r);if(-1===s)return void this.log("Delimiter not found in the buffer.");const o=s+r.length,i=e.length-o,a=new Uint8Array(i);for(let t=0;t<i;t++)a[t]=e[o+t];null===(n=this.requestQueue[t])||void 0===n||n.emit("data",a),this.log("Received audio chunk of size:",a.length)}findDelimiterIndex(e,t){for(let n=0;n<=e.length-t.length;n++){let r=!0;for(let s=0;s<t.length;s++)if(e[n+s]!==t[s]){r=!1;break}if(r)return n}return-1}getConfigMessage(){return`Content-Type:application/json; charset=utf-8\r\nPath:speech.config\r\n\r\n{\n      "context": {\n        "synthesis": {\n          "audio": {\n            "metadataoptions": {\n              "sentenceBoundaryEnabled": "true",\n              "wordBoundaryEnabled": "true"\n            },\n            "outputFormat": "${this.outputFormat}"\n          }\n        }\n      }\n    }`}getVoices(){return m(this,arguments,void 0,(function*(e=!0){try{if(e){const e=yield i.getCachedVoices();if(e)return this.log("Using cached voices:",e.length),e}this.log("Fetching voices from API...");const t=yield s.generateSecMsGec(),n=yield fetch(A.VOICES_URL,{headers:{"Sec-MS-GEC":t,"Sec-MS-GEC-Version":A.SEC_MS_GEC_VERSION,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Edg/130.0.0.0"}});if(!n.ok)throw new Error(`Failed to fetch voices: ${n.status} ${n.statusText}`);const r=yield n.json();if(!Array.isArray(r))throw new Error("Invalid voice list response format");return e&&(yield i.setCachedVoices(r),this.log("Cached",r.length,"voices")),r}catch(e){throw this.log("Error fetching voices:",e),new Error(`Failed to get voices: ${e instanceof Error?e.message:String(e)}`)}}))}setMetadata(e,t,n){return m(this,void 0,void 0,(function*(){if(this.voice=e,this.outputFormat=t,this.voiceLocale=n||this.inferLocaleFromVoiceName(e),!this.voiceLocale)throw new Error("Could not infer voiceLocale from voiceName!");this.ws&&this.ws.readyState===WebSocket.OPEN||(this.connectionStartTime=Date.now(),yield this.initWebSocket())}))}inferLocaleFromVoiceName(e){const t=A.VOICE_LANG_REGEX.exec(e);return t?t[0]:null}close(){var e;null===(e=this.ws)||void 0===e||e.close()}toStream(e,t=new d){if(e.length>1e4)throw new Error(`Text too long. Maximum length is 10000 characters, got ${e.length}`);if(!e.trim())throw new Error("Text cannot be empty");return this.sendSSMLRequest(this.buildSSML(e,t))}escapeSSML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}buildSSML(e,t){const n=this.escapeSSML(e);return`<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="${this.voiceLocale}">\n      <voice name="${this.voice}">\n        <prosody pitch="${t.pitch}" rate="${t.rate}" volume="${t.volume}">\n          ${n}\n        </prosody>\n      </voice>\n    </speak>`}sendSSMLRequest(e){if(!this.ws)throw new Error("WebSocket not initialized. Call setMetadata first.");const t=function(){const e=new Uint8Array(16);return window.crypto.getRandomValues(e),Array.from(e,(e=>`0${e.toString(16)}`.slice(-2))).join("")}(),n=`X-RequestId:${t}\r\nContent-Type:application/ssml+xml\r\nPath:ssml\r\n\r\n${e.trim()}`,r=new u;return this.requestQueue[t]=r,this.sendMessage(n).then(),r}}A.OUTPUT_FORMAT=a,A.CLIENT_TOKEN="6A5AA1D4EAFF4E9FB37E23D68491D6F4",A.VOICES_URL=`https://speech.platform.bing.com/consumer/speech/synthesize/readaloud/voices/list?trustedclienttoken=${A.CLIENT_TOKEN}`,A.SYNTH_URL=`wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1?TrustedClientToken=${A.CLIENT_TOKEN}`,A.BINARY_DELIM="Path:audio\r\n",A.VOICE_LANG_REGEX=/\w{2}-\w{2}/,A.SEC_MS_GEC_VERSION="1-130.0.2849.68";var h=n(72),p=n.n(h),f=n(825),x=n.n(f),v=n(659),b=n.n(v),w=n(56),y=n.n(w),E=n(159),T=n.n(E),S=n(113),C=n.n(S),k=n(640),N={};N.styleTagTransform=C(),N.setAttributes=y(),N.insert=b().bind(null,"head"),N.domAPI=x(),N.insertStyleElement=T(),p()(k.A,N),k.A&&k.A.locals&&k.A.locals;const M='\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-pause"><circle cx="12" cy="12" r="10"/><line x1="10" x2="10" y1="15" y2="9"/><line x1="14" x2="14" y1="15" y2="9"/></svg>\n';function _(e,t){if(e.innerHTML=`\n\t\t${t?'\n\t\t\t<div class="etts-flex-center etts-loading-container">\n\t\t\t\t<span>Generating audio...</span>\n\t\t\t\t<div class="etts-loading-spinner"></div>\n\t\t\t</div>\n\t\t':`\n\t\t\t<div class="etts-flex-center">\n\t\t\t\t<button id="tts-pause" class="etts-tts-button">\n\t\t\t\t\t${M}\n\t\t\t\t\t<span>Pause</span>\n\t\t\t\t</button>\n\t\t\t\t<button id="tts-stop" class="etts-tts-button etts-red">\n\t\t\t\t\t\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-stop"><circle cx="12" cy="12" r="10"/><rect x="9" y="9" width="6" height="6" rx="1"/></svg>\n\n\t\t\t\t\t<span>Stop</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`}\n\t`,!t){const t=e.querySelector("#tts-pause"),n=e.querySelector("#tts-stop");t&&t.addEventListener("click",(()=>{var e,t;null===(t=(e=window).togglePause)||void 0===t||t.call(e)})),n&&n.addEventListener("click",(()=>{var e,t;null===(t=(e=window).stopPlayback)||void 0===t||t.call(e)}))}}function L(e){return document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode:e=>{const t=e.parentElement;if(!t)return NodeFilter.FILTER_REJECT;const n=window.getComputedStyle(t);if("none"===n.display||"hidden"===n.visibility)return NodeFilter.FILTER_REJECT;const r=t.tagName.toLowerCase();return["script","style","noscript"].includes(r)||0===(e.textContent||"").trim().length?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}})}function O(e,t,n){const r=document.createRange();r.setStart(t,n),r.setEnd(document.body,document.body.childNodes.length);try{return r.intersectsNode(e)}catch(n){return!!(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING)}}let P=null,I=!1,F=null,U=null;function R(e){return n=this,r=void 0,o=function*(){U&&U(),H();try{const n=yield t().storage.sync.get({voiceName:"en-US-ChristopherNeural",customVoice:"",speed:1.2});F=yield function(){return e=this,n=arguments,s=function*(e=!0){const n=yield t().storage.sync.get({darkMode:!1}),r=document.createElement("div");return r.className="etts-tts-controls",r.id="tts-control-panel",n.darkMode&&(r.dataset.theme="dark"),_(r,e),document.body.appendChild(r),r},new((r=void 0)||(r=Promise))((function(t,o){function i(e){try{c(s.next(e))}catch(e){o(e)}}function a(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,a)}c((s=s.apply(e,n||[])).next())}));var e,n,r,s}(!0);const r=new A,s=n.customVoice||n.voiceName;yield r.setMetadata(s,a.WEBM_24KHZ_16BIT_MONO_OPUS);const o=new d;return o.rate=n.speed,new Promise(((t,n)=>{const s=new MediaSource;let i;const a=[];let c=!0,l=!0;U=()=>{l=!1},P||(P=new Audio,P.muted=!0,P.src=URL.createObjectURL(s),navigator.mediaSession.setActionHandler("play",(()=>null==P?void 0:P.play())),navigator.mediaSession.setActionHandler("pause",(()=>null==P?void 0:P.pause())),navigator.mediaSession.setActionHandler("stop",(()=>j())),P.onplay=()=>{P&&(P.muted=!1),I=!0,D()},P.onpause=()=>{I=!1,D()},P.onended=()=>{I=!1,D(),H()},P.onerror=e=>{console.error("Audio playback error:",e),H()}),F&&_(F,!1);const g=()=>{var e;if(l&&i&&"open"===s.readyState&&a.length>0&&!i.updating)try{const e=a.shift();if(e){const t=new Uint8Array(e.length);t.set(e),i.appendBuffer(t),c&&(navigator.userAgent.includes("Firefox")?setTimeout((()=>{null==P||P.play().catch((e=>{console.warn("Firefox autoplay workaround failed:",e)}))}),0):null==P||P.play().catch((e=>{console.warn("Audio playback failed:",e)})),c=!1)}}catch(t){console.error("appendNextChunk error:",t,"chunk length:",null===(e=a[0])||void 0===e?void 0:e.length),a.shift(),l&&setTimeout(g,100)}};s.addEventListener("sourceopen",(()=>{try{i=s.addSourceBuffer('audio/webm; codecs="opus"'),i.addEventListener("updateend",g);const n=r.toStream(e,o);n.on("data",(e=>{if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);t.set(e),a.push(t),g()}})),n.on("end",(()=>{const e=()=>{if(l)if(0!==a.length||i.updating)setTimeout(e,100);else try{s.endOfStream(),t(void 0)}catch(e){t(void 0)}};e()}))}catch(e){n(e)}}))}))}catch(e){throw console.error("TTS Error:",e),H(),e}},new((s=void 0)||(s=Promise))((function(e,t){function i(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(i,a)}c((o=o.apply(n,r||[])).next())}));var n,r,s,o}function D(){const e=document.querySelector("#tts-pause");if(e){const t=P&&!P.paused?"Pause":"Resume";e.innerHTML=`\n      ${P&&!P.paused?M:'\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-play"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>\n'}\n      <span>\n        ${t}\n      </span>\n    `}}function $(){P&&(P.paused?P.play():P.pause())}function j(){P&&(P.pause(),P.currentTime=0),H()}function H(){if(U&&(U(),U=null),P){P.onplay=null,P.onpause=null,P.onended=null,P.onerror=null,P.onloadstart=null,P.oncanplay=null;try{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("stop",null)}catch(e){}const e=P.src;P.pause(),P.src="",P.load(),e&&e.startsWith("blob:")&&URL.revokeObjectURL(e)}P=null,I=!1,F&&(F.querySelectorAll("button").forEach((e=>{var t;const n=e.cloneNode(!0);null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e)})),F.parentNode&&F.parentNode.removeChild(F)),F=null}window.togglePause=$,window.stopPlayback=j,t().runtime.onMessage.addListener((function(e,t,n){if("stopPlayback"===e.action)j();else if("togglePlayback"===e.action)$();else if("readText"===e.action)R(e.text).catch((e=>{console.error("TTS initialization error:",e)}));else if("readPage"===e.action){const e=document.body.innerText;e&&""!==e.trim()?R(e).catch((e=>{console.error("TTS initialization error:",e)})):console.warn("The page content is empty.")}else if("readFromHere"===e.action&&e.text)try{let t=function(){const e=window.getSelection();if(!e||0===e.rangeCount)return document.body.innerText;try{const t=e.getRangeAt(0);return function(e,t){const n=[];if(e.nodeType===Node.TEXT_NODE){const r=(e.textContent||"").substring(t);r.trim()&&n.push(r)}const r=e.nodeType===Node.TEXT_NODE?e.parentElement:e;if(!r)return n.join("");const s=L();let o=s.nextNode(),i=!1;for(;o;){if(!i){if(o===e){i=!0,o=s.nextNode();continue}if(!O(o,e,t)){o=s.nextNode();continue}i=!0}const r=o.textContent;r&&r.trim()&&n.push(r),o=s.nextNode()}return i?n.join(" ").replace(/\s+/g," ").trim():function(e){const t=[];let n=e;for(;n;){const e=L();let r=e.nextNode();for(;r;){const n=r.textContent;n&&n.trim()&&t.push(n),r=e.nextNode()}n=n.nextElementSibling}const r=e.parentElement;if(r&&r!==document.body){let e=r.nextElementSibling;for(;e;){const n=L();let r=n.nextNode();for(;r;){const e=r.textContent;e&&e.trim()&&t.push(e),r=n.nextNode()}e=e.nextElementSibling}}return t.join(" ").replace(/\s+/g," ").trim()}(r)}(t.startContainer,t.startOffset)}catch(e){return console.warn("Error extracting text from selection:",e),document.body.innerText}}(e.text);t&&0!==t.trim().length||(t=function(e){const t=window.getSelection();if(!t||0===t.rangeCount)return document.body.innerText;try{const t=document.body.innerText,n=t.indexOf(e);return-1!==n?t.substring(n):t}catch(e){return console.warn("Error in simple text extraction:",e),document.body.innerText}}(e.text)),t&&""!==t.trim()?R(t).catch((e=>{console.error("TTS initialization error:",e)})):(console.warn("No text found from selection point."),R(e.text).catch((e=>{console.error("TTS initialization error:",e)})))}catch(t){console.error("Error extracting text from selection:",t),R(e.text).catch((e=>{console.error("TTS initialization error:",e)}))}})),window.addEventListener("message",(e=>{if(e.source!==window)return;const{action:t,text:n}=e.data||{};"triggerTTS"===t&&"string"==typeof n&&R(n).catch((e=>console.error("initTTS error:",e)))})),window.addEventListener("beforeunload",(()=>{H()}))})()})();